<!DOCTYPE html>
<html>
<head>
	<title>akshatc2 vizualization</title>

	<link rel="stylesheet" type="text/css" href="dc.css">
</head>
<body>
<h1> AKSHATC2's GAME DATA VIZUALIZATION</h1>

<div id="sales">
	<h4>Publisher sales over the years</h4>
</div>

<div id="totalgames">
	<h4>Total games per Publisher</h4>
</div>

<div id="totalratings">
	<h4>Rating distribution of games</h4>
</div>

<script src="crossfilter.js"></script>
<script src="d3.js"></script>
<script src="dc.js"></script>

<script>
	
	
	var gamechart = dc.rowChart('#totalgames');
	var ratingchart = dc.rowChart('#totalratings');
	var saleschart = dc.lineChart('#sales');

	d3.csv("clean_Video_Games_Sales_till_2016.csv", function (err,data) {
		if (err) throw err;

		data.forEach(function(d){
			var tempDate = new Date(d.Year_of_Release);
			d.Year_of_Release = tempDate;
		})


		var ndx = crossfilter(data);
		var all = ndx.groupAll();

		var yearDim = ndx.dimension(function(d) {return d["Year_of_Release"]; });
		var salesDim = ndx.dimension(function(d) {return d["Global_Sales"]; });
		var pubDim = ndx.dimension(function(d) {return d["Pub_final"]; });
		var ratingDim = ndx.dimension(function(d) {return d["Rating"]; });
		//Sales by prime dimension
		/*var oneDim = ndx.dimension(function(d) {return d["Global_Sales"]; }).filterExact("Other");
		var twoDim = ndx.dimension(function(d) {return d["Global_Sales"]; }).filterExact("Electronic Arts");
		*/
		var salesGroup = yearDim.group().reduceSum(function(d) { return d.Global_Sales});
		var pubGroup = pubDim.group();
		var ratingGroup = ratingDim.group();
		//Prime dimension groups
		var oneGroup = yearDim.group().top(8)[0];
		var twoGroup = yearDim.group().top(8)[1];

		var mindate = new Date("1990");
		var maxdate = new Date("2016");

		saleschart
			.width(1200)
			.height(500)
			.dimension(yearDim)
			.group(oneGroup)
			.x(d3.time.scale().domain([mindate,maxdate]))
			.yAxisLabel("Sales in million")
			.renderArea(true);
		saleschart.stack(twoGroup);

		var gc = gamechart
			.dimension(pubDim)
			.group(pubGroup)
			.elasticX(true)
			.width(800)
			.height(200)
			.xAxis().ticks(10);

		ratingchart
			.dimension(ratingDim)
			.group(ratingGroup)
			.elasticX(true)
			.width(800)
			.height(200)
			.xAxis().ticks(10);

		dc.renderAll();

		/*function AddXAxis(chartToUpdate, displayText)
		{
    		chartToUpdate.svg()
                .append("text")
                .attr("class", "x-axis-label")
                .attr("text-anchor", "middle")
                .attr("x", chartToUpdate.width()/2)
                .attr("y", chartToUpdate.height()-3.5)
                .text(displayText);
		}
		AddXAxis(gc, "This is the x-axis!");*/
	});

</script>
</body>
</html>